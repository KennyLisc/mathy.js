"use strict";(function(e){function r(e){for(var r=-1;;)return r=e.indexOf(")",++r),~r?r:-1}function n(e,r,l,u){if(e.type===s.placeholder&&e.value===r)return e.type=s.group,e.children.push(i(l,u)),!0;for(var a=0;e.children.length>a;a+=1)if(n(e.children[a],r,l,u))return!0;return!1}function l(e,r,n){var l=r.slice(0,e),u=r.slice(e+1).split(":"),a=new h(s.decision);if("true"===l.toLowerCase())a.children.push(new h(s.boolean,!0));else if("false"===l.toLowerCase())a.children.push(new h(s.boolean,!1));else{var t;e=l.indexOf("==="),~e?(t=new h(s.equal),t.children.push(i(l.slice(0,e),n)),t.children.push(i(l.slice(e+3),n))):~(e=l.indexOf("!=="))?(t=new h(s.notEqual),t.children.push(i(l.slice(0,e),n)),t.children.push(i(l.slice(e+3),n))):~(e=l.indexOf("<"))?(t=new h(s.lessThan),t.children.push(i(l.slice(0,e),n)),t.children.push(i(l.slice(e+1),n))):~(e=l.indexOf(">"))?(t=new h(s.greaterThan),t.children.push(i(l.slice(0,e),n)),t.children.push(i(l.slice(e+1),n))):t=i(l,n),a.children.push(t)}return u.length?(a.children.push(i(u[0],n)),a.children.push(i(u[1],n))):(a.children.push(new h(s.value,!0)),a.children.push(new h(s.value,!1))),a}function i(e,u){var t,d,p,o;if(e=e.replace(a,""),t=e.lastIndexOf("("),~t){var v=t+r(e.slice(t));d=e.slice(0,t),p=e.slice(t+1,v);var f=e.slice(v+1);o=new h(s.group);var m=++c;return o.children.push(i(d+"$"+m+f,u)),n(o.children[0],m,p,u),o}if(t=e.indexOf("?"),~t)return l(t,e,u);if(t=e.lastIndexOf("+"),~t)return o=new h(s.add),d=e.slice(0,t).trim(),d&&o.children.push(i(d,u)),p=e.slice(t+1).trim(),p&&o.children.push(i(p,u)),o;if(t=e.lastIndexOf("-"),~t)return o=new h(s.subtraction),d=e.slice(0,t).trim(),o.children.push(i(d,u)),p=e.slice(t+1).trim(),p&&o.children.push(i(p,u)),o;if(t=e.lastIndexOf("*"),~t)return o=new h(s.multiply),d=e.slice(0,t).trim(),d&&o.children.push(i(d,u)),p=e.slice(t+1).trim(),p&&o.children.push(i(p,u)),o;if(t=e.lastIndexOf("/"),~t)return o=new h(s.division),d=e.slice(0,t).trim(),d&&o.children.push(i(d,u)),p=e.slice(t+1).trim(),p&&o.children.push(i(p,u)),o;if(t=e.lastIndexOf("^"),~t)return o=new h(s.power),d=e.slice(0,t).trim(),d&&o.children.push(i(d,u)),p=e.slice(t+1).trim(),p&&o.children.push(i(p,u)),o;if("$"===e[0])return new h(s.placeholder,parseInt(e.slice(1),10));var g=u.filter(function(r){return r.name===e})[0];if(g)return e=g.derivation,i(e,u);e=e.trim();var w;return w=parseInt(e,10),isNaN(w)&&(w="true"===e,w||(w=!("false"===e),w&&(w=e))),new h(s.value,w)}function u(e){if(!e)return 0;for(var r=0;e.children.length>r;r+=1)u(e.children[r]);switch(e.type){case s.add:return e.value=e.children[0].value+e.children[1].value;case s.subtraction:return e.value=e.children[0].value-e.children[1].value;case s.multiply:return e.value=e.children[0].value*e.children[1].value;case s.division:return e.value=e.children[0].value/e.children[1].value;case s.group:return e.value=u(e.children[0]);case s.power:return e.value=Math.pow(e.children[0].value,e.children[1].value);case s.value:return e.value;case s.decision:return e.value=e.children[0].value?e.children[1].value:e.children[2].value;case s.boolean:return e.value;case s.equal:return e.value=e.children[0].value===e.children[1].value;case s.notEqual:return e.value=e.children[0].value!==e.children[1].value;case s.lessThan:return e.value=e.children[0].value<e.children[1].value;case s.greaterThan:return e.value=e.children[0].value>e.children[1].value}return 0}var a=/\s+/gi,t=function(){function e(){for(var e=[],r=0;arguments.length-0>r;r++)e[r]=arguments[r+0];this.getRules=function(){return e}}return e.prototype.add=function(){for(var e=[],r=0;arguments.length-0>r;r++)e[r]=arguments[r+0];var n=this.getRules();n.push.apply(n,e)},e.prototype.process=function(){for(var e,r=this.getRules(),n=1===r.length?r:r.filter(function(e){return e.result},[]),l=[],a=0;n.length>a;a+=1)e=i(n[a].derivation,r),l.push(u(e));return l},e}();e.Engine=t;var s,c=0,h=function(){function e(e,r,n){r===void 0&&(r=0),n===void 0&&(n=[]),this.type=e,this.value=r,this.children=n}return e}();(function(e){e._map=[],e._map[0]="add",e.add=0,e._map[1]="subtraction",e.subtraction=1,e._map[2]="multiply",e.multiply=2,e._map[3]="division",e.division=3,e._map[4]="group",e.group=4,e._map[5]="power",e.power=5,e._map[6]="value",e.value=6,e._map[7]="placeholder",e.placeholder=7,e._map[8]="decision",e.decision=8,e._map[9]="boolean",e.boolean=9,e._map[10]="equal",e.equal=10,e._map[11]="notEqual",e.notEqual=11,e._map[12]="lessThan",e.lessThan=12,e._map[13]="greaterThan",e.greaterThan=13})(s||(s={}))})(exports.mathy||(exports.mathy={}));var mathy=exports.mathy;
//@ sourceMappingURL=src/mathy.min.js.map